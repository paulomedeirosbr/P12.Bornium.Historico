unit Bornium.H.Servidor.OBJ_MontaFiltro_FORNECEDOR;

interface

uses
  Bornium.H.Servidor.OBJ_MontaFiltro_ColecaoPadrao;

Type
  TOBJ_MontaFiltro_FORNECEDOR = Class(TOBJ_ColecaoPadrao)

    class function getInstance : TOBJ_MontaFiltro_FORNECEDOR;

    function Executar(ACodEmpresa :Integer; ACodRegistro :Variant; ANomeUsuario :String; ADataInicio :TDateTime) :String; Override;

  End;

implementation

uses
  System.SysUtils, Variants;

var
  oTabela :TOBJ_MontaFiltro_FORNECEDOR;

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

class function TOBJ_MontaFiltro_FORNECEDOR.getInstance: TOBJ_MontaFiltro_FORNECEDOR;
begin
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  if not Assigned(oTabela) then begin
    oTabela:= TOBJ_MontaFiltro_FORNECEDOR.ObjCriar;
  end;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  Result:= oTabela;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
end;

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

function TOBJ_MontaFiltro_FORNECEDOR.Executar(ACodEmpresa :Integer; ACodRegistro :Variant; ANomeUsuario :String; ADataInicio :TDateTime): String;
begin
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  oFiltro.Clear;
  oFiltro.Append('{');
  oFiltro.Append(' "' + UpperCase('cdEmpresa')    + '": "' + ACodEmpresa  .toString + '"');
  oFiltro.Append(',"' + UpperCase('cdFornecedor') + '": "' + VarToStr(ACodRegistro) + '"');
  oFiltro.Append('}');
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  Result:= oFiltro.ToString;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
end;

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

initialization

finalization

   if Assigned(oTabela) then begin
     oTabela.ObjDestruir;
     oTabela:= nil;
   end;

end.
