unit Bornium.H.Servidor.FRM_FPrincipal;

//##############################################################################################################################################################
//
//  Objetivo:
//
//##############################################################################################################################################################
//
//  Revisão: xx/xx/xx - Quem - O que?
//
//##############################################################################################################################################################

interface

uses
  Winapi.Messages, Vcl.AppEvnts, Vcl.ExtCtrls, Vcl.StdCtrls, Vcl.Controls,
  System.Classes, Vcl.Forms, Bornium.H.Servidor.DTM_FPrincipal,
  System.SysUtils, Vcl.Dialogs, Geral.A07_008.OBJ_LogWin;

type
  TFRM_FPrincipal = class(TForm)
    ApEvento: TApplicationEvents;
    Panel2: TPanel;
    Bevel1: TBevel;
    BtFechar: TButton;
    BtConectar: TButton;
    BtDesconectar: TButton;
    procedure FormCreate(Sender: TObject);
    procedure BtConectarClick(Sender: TObject);
    procedure BtDesconectarClick(Sender: TObject);
    procedure BtFecharClick(Sender: TObject);
    procedure FormDestroy(Sender: TObject);
    procedure FormActivate(Sender: TObject);
    procedure ApEventoException(Sender: TObject; E: Exception);
  private

    DTM : TDTM_FPrincipal;

    procedure VerJanela;

  public

  end;

var
  FRM_FPrincipal: TFRM_FPrincipal;

implementation

uses
  Bornium.H.Servidor.CTE_VersaoServidor, Bornium.H.Servidor.A00_Revisao;

{$R *.dfm}

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

procedure TFRM_FPrincipal.FormCreate(Sender: TObject);
begin
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  Revisao:= TBorniumH_Servidor.;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
//  self.Height := 135; self.Width  := 525;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  DTM:= TDTM_FPrincipal.Create(Self);
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
// Caption := Caption + ' - ' + VersaoSistema;
  Caption := 'Servidor Mongo DB' + ' - ' + CTE_VERSAO_SERVIDOR;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
end;

procedure TFRM_FPrincipal.FormDestroy(Sender: TObject);
begin
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  FreeAndNil(DTM);
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
end;

procedure TFRM_FPrincipal.FormActivate(Sender: TObject);
begin
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  BtConectar    .Enabled:= False;
  BtDesconectar .Enabled:= False;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  BtConectarClick(Sender);
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
end;

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

procedure TFRM_FPrincipal.ApEventoException(Sender: TObject; E: Exception);
begin
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  ShowMessage(E.Message);
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
end;

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

procedure TFRM_FPrincipal.BtConectarClick(Sender: TObject);
begin
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  try
    BtConectar.Enabled:= False;
    DTM.Iniciar;
  Except
    on E : Exception do begin
      TOBJ_LogWin.Registrar(E.Message + '->' + ClassName +'.BtIniciarClick');
    end;
  end;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  VerJanela;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
end;

procedure TFRM_FPrincipal.BtDesconectarClick(Sender: TObject);
begin
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  try
    BtDesconectar .Enabled:= False;
    DTM.Parar;
  Except
    on E : Exception do begin
      TOBJ_LogWin.Registrar(E.Message + '->' + ClassName +'.BtPararClick');
    end;
  end;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  VerJanela;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
end;

procedure TFRM_FPrincipal.BtFecharClick(Sender: TObject);
begin
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  Close;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
end;

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

procedure TFRM_FPrincipal.VerJanela;
begin
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  try
    BtConectar    .Enabled:= False;
    BtDesconectar .Enabled:= False;
    BtFechar      .Enabled:= False;

    if Assigned(DTM) then begin
      BtConectar    .Enabled := DTM.EstaConectado = False;
      BtDesconectar .Enabled := DTM.EstaConectado = True;
      BtFechar      .Enabled := DTM.EstaConectado = False;
    end;
  Except
    on E : Exception do begin
      TOBJ_LogWin.Registrar(ClassName + '.RelogioTimer->' + E.Message)
    end;
  end;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
end;

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

end.
