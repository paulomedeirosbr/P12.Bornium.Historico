unit Bornium.Log.OBJ_MongoBD;

interface

uses
  System.SysUtils, System.Classes, PythonEngine, Vcl.PythonGUIInputOutput;

type
  TOBJ_MongoBD = class(TDataModule)
    PythonEngine: TPythonEngine;
    PythonInputOutput: TPythonInputOutput;
    procedure DataModuleCreate(Sender: TObject);
    procedure DataModuleDestroy(Sender: TObject);
    procedure PythonInputOutputSendData(Sender: TObject; const Data: AnsiString);
  private

  public

    function Executar (AScript :String) : String;

  end;

implementation

{$R *.dfm}

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

function TOBJ_MongoBD.ExecutarGet(AScript :String): String;
var
  Script:String;
begin
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  RespotaPython:= '';
  AScript:= UTF8Encode(AScript);
  GetPythonEngine.ExecString(AScript);
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  Result:= StringReplace(RespotaPython,'''', '"',[rfReplaceAll, rfIgnoreCase]);
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
end;

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

function TOBJ_MongoBD.ExecutarPost(AJson :String): String;
var
  Script:String;
begin
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
   oSisPython.Clear;
   oSisPython.Add(L1_ImportModulo);
   oSisPython.Add(L2_ConexaoMontoDB('',''));
   oSisPython.Add(L3_ConectarBancoDados(''));
   oSisPython.Add(L4_ConectarTabela(''));
   oSisPython.Add(L5_InserirJSon(AJson));
   oSisPython.Add(L6_InserirObjeto);

   Script:= UTF8Encode(oSisPython.Text);

   GetPythonEngine.ExecString(Script);
   Result:= 'Executando POST';
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
end;

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$


function TOBJ_MongoBD.ExecutarPost2(AScript :String): String;
var
  Script:String;
begin
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  RespotaPython:= '';
  AScript:= UTF8Encode(AScript);
  GetPythonEngine.ExecString(AScript);
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  Result:= StringReplace(RespotaPython,'''', '"',[rfReplaceAll, rfIgnoreCase]);
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
end;



//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$


end.
