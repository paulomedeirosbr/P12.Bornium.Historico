unit TesteDLL.FRM_FPrincipal;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.ExtCtrls, Data.DB, Vcl.Grids, Vcl.DBGrids, Datasnap.DBClient;

type
  TFRM_FPrincipal = class(TForm)
    Panel1: TPanel;
    BtGravarInformacao: TButton;
    BtRecuperarInformacao: TButton;
    BtConexaoAbrir: TButton;
    BtConexaoFechar: TButton;
    Panel2: TPanel;
    Panel3: TPanel;
    DBGrid2: TDBGrid;
    DBGrid1: TDBGrid;
    Panel4: TPanel;
    TabPadrao: TClientDataSet;
    DsPadrao: TDataSource;
    Panel5: TPanel;
    Label1: TLabel;
    Label2: TLabel;
    EdServidor: TEdit;
    EdPorta: TEdit;
    Label3: TLabel;
    EdCodEmpresa: TEdit;

    procedure BtGravarInformacaoClick(Sender: TObject);
    procedure BtRecuperarInformacaoClick(Sender: TObject);
    procedure BtConexaoAbrirClick(Sender: TObject);
    procedure BtConexaoFecharClick(Sender: TObject);

    procedure FormActivate(Sender: TObject);
    procedure Panel4Click(Sender: TObject);
    procedure FormCreate(Sender: TObject);

  private

    EstaConectado :Boolean;

    procedure VerJanela;

    function MontaListaInfoAlterada :WideString;

  public

  end;

var
  FRM_FPrincipal: TFRM_FPrincipal;

implementation

Const
  CTE_NomeBaseDados = 'BORNIUM';

function FUNC_01_ConecaoAbrir(AServidor, APorta :WideString)  :Boolean; stdcall; external 'Bornium.H.MongoDB.dll';
function FUNC_02_ConexaoFechar :Boolean; stdcall; external 'Bornium.H.MongoDB.dll';

procedure PROC_03_InfoGravar        (ANomeBaseDados, AnomeColecao, AInformacao : WideString); stdcall; external 'Bornium.H.MongoDB.dll';

procedure PROC_04_ApresentarHitorico(ACodEmpresa, ACodProcesso, ACodRegistro, AServidor, APorta :WideString); stdcall; external 'Bornium.H.MongoDB.dll';

{$R *.dfm}

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

procedure TFRM_FPrincipal.FormCreate(Sender: TObject);
begin
//--------------------------------------------------------------------------------------------------------------------------------------------------------------

//--------------------------------------------------------------------------------------------------------------------------------------------------------------
end;


//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

procedure TFRM_FPrincipal.FormActivate(Sender: TObject);
begin
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  VerJanela;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
end;


procedure TFRM_FPrincipal.Panel4Click(Sender: TObject);
begin

end;

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

procedure TFRM_FPrincipal.BtGravarInformacaoClick(Sender: TObject);
var
  ListaInfo :String;
begin
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  ListaInfo:= MontaListaInfoAlterada;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  try 
    PROC_03_InfoGravar(CTE_NomeBaseDados, 'TESTE', ListaInfo);
    showmessage('');
  except
    raise Exception.Create('Erro ao Gravar Informação');
  end;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
end;

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

procedure TFRM_FPrincipal.BtRecuperarInformacaoClick(Sender: TObject);
var
  Informacao :String;
begin
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  PROC_04_ApresentarHitorico(EdCodEmpresa.Text, '1', '1', EdServidor.Text, EdPorta.Text);
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
end;

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

procedure TFRM_FPrincipal.BtConexaoAbrirClick(Sender: TObject);
begin
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  try
    EstaConectado:= FUNC_01_ConecaoAbrir(EdServidor.Text, EdPorta.Text);
  except
    Raise;
  end;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  VerJanela;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
end;

procedure TFRM_FPrincipal.BtConexaoFecharClick(Sender: TObject);
begin
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  try
    FUNC_02_ConexaoFechar;
    EstaConectado:= False;
  except
    Raise;
  end;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  VerJanela;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
end;

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

procedure TFRM_FPrincipal.VerJanela;
begin
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  BtConexaoAbrir  .Enabled:= not EstaConectado;
  BtConexaoFechar .Enabled:= EstaConectado;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
  BtGravarInformacao   .Enabled:= EstaConectado;
  BtRecuperarInformacao.Enabled:= EstaConectado;
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
end;

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

function TFRM_FPrincipal.MontaListaInfoAlterada :WideString;
begin
//--------------------------------------------------------------------------------------------------------------------------------------------------------------

//--------------------------------------------------------------------------------------------------------------------------------------------------------------
end;


end.
